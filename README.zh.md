# Tipy

## ä¸€ç§æœ‰å“ä½çš„ã€æ›´èˆ’é€‚çš„ C è¯­è¨€

> Tipy is a statically-typed, compiled programming language, designed with a core philosophy: to be a **more tasteful, comfortable C**.

`tipy` æ—¨åœ¨èåˆ C è¯­è¨€çš„åº•å±‚æ§åˆ¶èƒ½åŠ›å’Œæ€§èƒ½ï¼Œä¸ç°ä»£è¯­è¨€çš„äººä½“å·¥ç¨‹å­¦åŠå®‰å…¨æ€§ã€‚æˆ‘å¸Œæœ›åœ¨ä¿ç•™æ‰‹åŠ¨å†…å­˜ç®¡ç†ç­‰åº•å±‚ç‰¹æ€§çš„åŒæ—¶ï¼Œæä¾›ä¸€ç§æ›´å¯Œæœ‰è¡¨ç°åŠ›ã€æ›´ä¸å®¹æ˜“å‡ºé”™çš„ç¼–ç¨‹ä½“éªŒã€‚

å‘Šåˆ«å¤´æ–‡ä»¶ï¼ˆ`#include <headache.h>`ï¼‰ï¼Œå‘Šåˆ« `NULL` å’Œæ‚¬å‚æŒ‡é’ˆï¼Œ`tipy` è‡´åŠ›äºæä¾›ä¸€ç§ç‹¬ç‰¹çš„ã€ç®€æ´ä¸”ä¸€è‡´çš„â€œå“å‘³ (taste)â€ã€‚

-----

## âœ¨ é¡¹ç›®çŠ¶æ€ (Project Status)

**å½“å‰ç‰ˆæœ¬: v0.0.3-alpha**

æœ¬é¡¹ç›®æ­£å¤„äºæ—©æœŸçš„ Alpha å¼€å‘é˜¶æ®µã€‚æˆ‘ä»¬åˆšåˆšå®Œæˆäº†ä¸€ç³»åˆ—æ¿€åŠ¨äººå¿ƒçš„é‡Œç¨‹ç¢‘ï¼Œä¸º Tipy çš„æœªæ¥å¥ å®šäº†åšå®çš„åŸºç¡€ï¼

  * âœ… **v0.0.1: Hello, World\!**

      * æˆåŠŸå®ç° "Hello, World\!" çš„ç«¯åˆ°ç«¯ç¼–è¯‘ï¼Œæ‰“é€šäº†ä»æºä»£ç åˆ°åŸç”Ÿå¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´æµç¨‹ã€‚

  * âœ… **v0.0.2: åšç‚¹æ•°å­¦ (Do Some Maths\!)**

      * å¼•å…¥äº†å˜é‡å£°æ˜ (`:`)ã€èµ‹å€¼ (`=`) å’Œå¯å˜æ€§æ ‡è®° (`~`)ã€‚
      * æ”¯æŒäº† `i32` å’Œ `f64` åŸç”Ÿç±»å‹åŠåŸºæœ¬çš„å››åˆ™è¿ç®—ã€‚
      * å®ç°äº† Pratt Parser æ¥æ­£ç¡®å¤„ç†è¿ç®—ç¬¦ä¼˜å…ˆçº§ã€‚

  * âœ… **v0.0.3: å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ (Functions are First-Class)**

      * å®ç°äº†åŒ…å«å‚æ•°å’Œè¿”å›å€¼çš„å®Œæ•´å‡½æ•°å®šä¹‰è¯­æ³• (`->`)ã€‚
      * é‡æ„å¹¶å®ç°äº†**ä¸¤éå¼è¯­ä¹‰åˆ†æ (Two-Pass Semantic Analysis)**ï¼Œæ”¯æŒå‡½æ•°é—´çš„ç›¸äº’è°ƒç”¨å’Œå‰å‘å¼•ç”¨ã€‚
      * å»ºç«‹äº†åŸºäºæ ˆçš„ä½œç”¨åŸŸå’Œç¬¦å·è¡¨ï¼Œæ­£ç¡®å¤„ç†å‡½æ•°å‚æ•°å’Œå±€éƒ¨å˜é‡ã€‚
      * ä»£ç ç”Ÿæˆå™¨ (`CodeGen`) å·²å®Œå…¨é‡æ„ï¼Œèƒ½å¤Ÿä¸ºå‡½æ•°ã€å˜é‡å’Œè¡¨è¾¾å¼ç”Ÿæˆæ­£ç¡®çš„ LLVM IRã€‚

-----

## ğŸ‘‹ Hello, Tipy World\! (v0.0.3 Style)

éšç€å‡½æ•°ç³»ç»Ÿçš„å®Œå–„ï¼Œ`tipy` ç°åœ¨èƒ½åšæ›´å¤šäº‹æƒ…äº†ï¼

```tipy
// main.tp
add(a: i32, b: i32) -> i32 {
    ret a + b
}

main() -> i32 {
    a: i32 = 10;
    b: ~i32 = 20;
    b = add(a, b * 2); // åº”è¯¥è®¡ç®—ä¸º add(10, 40) = 50
    ret b;
}
```

æˆ‘ä»¬çš„ç¼–è¯‘å™¨ (`tipyc`) ä¼šå°†ä¸Šè¿°ä»£ç ç¼–è¯‘æˆç±»ä¼¼ä¸‹é¢è¿™æ ·çš„ LLVM ä¸­é—´è¡¨ç¤º (IR)ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå®ƒå·²ç»åŒ…å«äº†ä¸¤ä¸ªå‡½æ•°å®šä¹‰ã€æ ˆåˆ†é… (`alloca`)ã€åŠ è½½/å­˜å‚¨ (`load`/`store`)ã€è¿ç®—å’Œå‡½æ•°è°ƒç”¨ (`call`)ï¼š

```llvm
; ModuleID = 'tipy_module'
source_filename = "tipy_module"

define i32 @add(i32 %a, i32 %b) {
entry:
  %a1 = alloca i32, align 4
  store i32 %a, ptr %a1, align 4
  %b2 = alloca i32, align 4
  store i32 %b, ptr %b2, align 4
  %tmp_load = load i32, ptr %a1, align 4
  %tmp_load3 = load i32, ptr %b2, align 4
  %tmpadd = add i32 %tmp_load, %tmp_load3
  ret i32 %tmpadd
}

define i32 @main() {
entry:
  %b = alloca i32, align 4
  %a = alloca i32, align 4
  store i32 10, ptr %a, align 4
  store i32 20, ptr %b, align 4
  %tmp_load = load i32, ptr %a, align 4
  %tmp_load1 = load i32, ptr %b, align 4
  %tmpmul = mul i32 %tmp_load1, 2
  %tmpcall = call i32 @add(i32 %tmp_load, i32 %tmpmul)
  store i32 %tmpcall, ptr %b, align 4
  %tmp_load2 = load i32, ptr %b, align 4
  ret i32 %tmp_load2
}
```

-----

## ğŸ—ºï¸ è·¯çº¿å›¾ (Roadmap)

æˆ‘æ­£åœ¨å‘ç€ `v0.1.0` çš„ç›®æ ‡å‰è¿›ï¼Œè®¡åˆ’å®ç°ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

  * [x] **v0.0.1: Hello, World\!**
  * [x] **v0.0.2: å˜é‡ä¸è¿ç®— (Variables & Operations)**
      * [x] å˜é‡å£°æ˜ä¸èµ‹å€¼
      * [x] åŸç”Ÿç±»å‹ (`i32`, `f64`) & åŸºæœ¬ç®—æœ¯
  * [x] **v0.0.3: å‡½æ•°ç³»ç»Ÿ (Function System)**
      * [x] å®Œæ•´å‡½æ•°å®šä¹‰ã€å‚æ•°ã€è¿”å›å€¼
      * [x] ä½œç”¨åŸŸä¸ç¬¦å·è¡¨
      * [x] ç«¯åˆ°ç«¯å‡½æ•°è°ƒç”¨
  * [ ] **æ§åˆ¶æµ**: `if-else` è¡¨è¾¾å¼ã€`loop`ã€`while`ã€‚
  * [ ] **åŸç”Ÿç±»å‹æ‰©å±•**: å¸ƒå°”ã€å­—ç¬¦ã€å­—ç¬¦ä¸²ã€‚
  * [ ] **ç±»ä¸æšä¸¾**: åˆæ­¥çš„ `class` å’Œ `enum` å®šä¹‰ã€‚
  * [ ] **å†…å­˜ç®¡ç†**: æ‰‹åŠ¨å†…å­˜ç®¡ç† (`new`, `free`) åŠç›¸å…³çš„å®‰å…¨ä¿è¯ã€‚
  * [ ] **æŒ‡é’ˆ**: ç‹¬ç‰¹çš„ `^` æŒ‡é’ˆè¯­æ³•å’Œç±»å‹ç³»ç»Ÿã€‚

-----

## ğŸš€ å¦‚ä½•æ„å»ºä¸è¿è¡Œ (v0.0.3)

**å…ˆå†³æ¡ä»¶:**

1.  **Rust å·¥å…·é“¾**: å‰å¾€ [rust-lang.org](https://rust-lang.org) å®‰è£…ã€‚
2.  **LLVM å·¥å…·é“¾**: éœ€è¦ä¸ `inkwell` ä¾èµ–ç‰ˆæœ¬åŒ¹é…çš„ LLVMã€‚æœ¬é¡¹ç›®å½“å‰ä½¿ç”¨ **LLVM 18**ã€‚
    ```bash
    # ä»¥ Ubuntu ä¸ºä¾‹
    sudo apt install llvm-18 clang-18
    ```

**æ„å»ºä¸è¿è¡Œæ­¥éª¤:**

1.  **è¿è¡Œä½ çš„ç¼–è¯‘å™¨**:
    è¿™ä¸€æ­¥ä¼šç¼–è¯‘å¹¶è¿è¡Œ `tipyc` (å³æ‚¨çš„ `func` äºŒè¿›åˆ¶æ–‡ä»¶) æœ¬èº«ï¼Œå®ƒä¼šè¯»å–å†…ç½®çš„ Tipy æºç ï¼Œå¹¶ç”Ÿæˆ `output.ll` æ–‡ä»¶ã€‚

    ```bash
    cargo run
    ```

2.  **å°† LLVM IR ç¼–è¯‘ä¸ºç›®æ ‡æ–‡ä»¶**:
    ä½¿ç”¨ `llc` å°†äººç±»å¯è¯»çš„ IR è½¬æ¢ä¸ºäºŒè¿›åˆ¶ç›®æ ‡æ–‡ä»¶ã€‚

    ```bash
    llc-18 -filetype=obj -relocation-model=pic -o output.o output.ll
    ```

3.  **é“¾æ¥ä¸ºå¯æ‰§è¡Œæ–‡ä»¶**:
    ä½¿ç”¨ `clang` å°†ä½ çš„ç›®æ ‡æ–‡ä»¶é“¾æ¥èµ·æ¥ã€‚

    ```bash
    clang-18 output.o -o my_program
    ```

4.  **è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ª Tipy ç¨‹åº\!**

    ```bash
    ./my_program
    ```

5.  **æ£€æŸ¥ç¨‹åºè¿”å›å€¼**:
    æˆ‘ä»¬çš„ `main` å‡½æ•° `ret b;`ï¼Œå…¶æœ€ç»ˆå€¼æ˜¯ `50`ã€‚åœ¨ Linux æˆ– macOS ä¸Šï¼Œä½ å¯ä»¥ç”¨ `echo $?` æ¥æ£€æŸ¥ä¸Šä¸€ä¸ªå‘½ä»¤çš„é€€å‡ºç ã€‚

    ```bash
    echo $?
    # è¾“å‡º: 50
    ```

-----

## ğŸ¤ å¦‚ä½•è´¡çŒ® (How to Contribute)

æˆ‘éå¸¸æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼æ— è®ºæ˜¯æäº¤ issueã€ä¿®å¤ bugã€å®ç°æ–°åŠŸèƒ½ï¼Œè¿˜æ˜¯æ”¹è¿›æ–‡æ¡£ï¼Œéƒ½å¯¹è¿™ä¸ªé¡¹ç›®è‡³å…³é‡è¦ã€‚

1.  Fork æœ¬ä»“åº“ã€‚
2.  åˆ›å»ºä½ çš„åŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)ã€‚
3.  æäº¤ä½ çš„æ”¹åŠ¨ (`git commit -m 'Add some AmazingFeature'`)ã€‚
4.  æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)ã€‚
5.  æäº¤ä¸€ä¸ª Pull Requestã€‚

-----

## ğŸ“ è®¸å¯ (License)

æœ¬é¡¹ç›®é‡‡ç”¨ [Apache-2.0 è®¸å¯è¯](https://www.google.com/search?q=LICENSE)æˆæƒã€‚